rules:
  fall_slide:
    if: DOWN.mat.density < SELF.mat.density
    do:
      - SWAP SELF DOWN
    else:
      if: RIGHT.mat.density < SELF.mat.density and DOWNRIGHT.mat.density < SELF.mat.density
      do: SWAP SELF DOWNRIGHT
    mirrored: true
  horizontal_slide:
    if: isType_liquid(SELF) and RIGHT.mat.density < SELF.mat.density
    do: SWAP SELF RIGHT
    else:
      if: isType_liquid(DOWN) and DOWNRIGHT.mat.density < DOWN.mat.density
      do: SWAP DOWN DOWNRIGHT
    mirrored: true
  rise_up:
    if: isType_gas(DOWN) and not isType_solid(SELF) and DOWN.mat.density < SELF.mat.density
    do: SWAP DOWN SELF
    else:
      if: isType_gas(DOWN) and not isType_solid(RIGHT) and DOWN.mat.density < RIGHT.mat.density
      do: SWAP DOWN RIGHT
    precondition: false


types:
  solid:
  movable_solid:
    inherits: solid
    base_rules: [
        fall_slide
    ]
  liquid:
    base_rules: [
        fall_slide,
        horizontal_slide
    ]
  gas:
    base_rules: [
      rise_up
    ]
  plant:


materials:
  sand:
    type: movable_solid
    color: [1.0, 1.0, 0]
    density: 1.5
  
  rock:
    type: solid
    color: [0.4, 0.4, 0.4]
    density: 4.0

  water:
    type: liquid
    color: [0.0, 0.0, 1.0, 0.5]
    density: 1.5

  radioactive:
    type: solid
    color: [0.196, 0.55, 0.184]
    emission: [0.05, 0.7, 0.05, 0.9]
    density: 5.0
  
  smoke:
    type: gas
    color: [0.3, 0.3, 0.3, 0.3]
    density: 0.1
  
  toxic_sludge:
    type: liquid
    color: [0.0, 0.7, 0.2, 0.5]
    emission: [0.0, 0.5, 0.0, 0.99999]
    density: 1.8
  
  # vine:
  #   type: plant
  #   color: [0.14, 0.5, 0.19]
  #   density: 2.5
  #   extra_rules: [
  #     vine_rule
  #   ]